@startuml
!include ../../copyright.iuml

title Refetch Content Range

actor Client
participant "<&data-transfer-download> Content + <&badge> Entity" as Content

Client -> Content: GET / HEAD
Content --> Client: 200 OK
rnote left #lightgreen
  <#lightgreen,lightgreen>|= Header |= Value |
  | ""accept-ranges:"" | ""bytes"" |
  | ""etag:"" | //entity-tag// |
  | ""content-length:"" | //byte-count// |
  | ""content-type:"" | //media-type// |
  | ""last-modified:"" | //HTTP-date// |
  | ""content-disposition:"" | //disposition// |
  | ""profile:"" | ""<https://level3.rest/profiles/content>,"" |
  | | ""<https://level3.rest/profiles/mixins/entity>"" |
end note
|||
Client -> Content: GET
note left
  Only changed
  headers displayed
end note
rnote right #lightblue
  <#lightblue,lightblue>|= Header |= Value |
  | ""if-range:"" | //entity-tag or HTTP-date// |
  | ""range:"" | ""bytes=""//byte-range// |
end note
Content --> Client: 206 Partial Content
rnote left #lightgreen
  <#lightgreen,lightgreen>|= Header |= Value |
  | ""content-length:"" | //byte-count// |
  | ""content-range:"" | ""bytes"" //byte-range//""/""//total// |
end note
hnote over Client #darkseagreen: ""...partial bytes...""
group changed: refetch
  Content --> Client: 200 OK
  rnote left #lightgreen
    <#lightgreen,lightgreen>|= Header |= Value |
    | ""content-length:"" | //byte-count// |
  end note
  hnote over Client #darkseagreen: ""...all bytes...""
end
group failure: rejected
  Content -->o Client: 416 Range Not Satisfiable
  rnote left #lightgreen
    <#lightgreen,lightgreen>|= Header |= Value |
    | ""content-range:"" | ""bytes */""//total// |
  end note
end

@enduml
